@model IEnumerable<Tusimaka.Model.strekning>

@{
    ViewBag.Title = "FlyruterAdministrer";
}
<script type="text/javascript">
    $(document).ready(function () {
        // lag en hendelse som utføres når en a-href med "data-SletteModal = true" trykkes.
        $('a[data-sletteFlyruterModal=true]').click(function () {

            // hent inn data-taggene fra denne a-hef lenken
            var data_navn = $(this).data('navn');
            var data_id = $(this).data('id');

            // legg ut dataene i div'en i modal-view'et
            $('#slettFlyrute').html(data_navn);

            // lag en hendelse for knappen for å slette via ajax, knappen ligger i modal-view'et
            // må ligge inne i denne overordnede funksjonen for at id'én som er valgt kan brukes
            $("#sletteFlyruteModalKnapp").click(function () {
                // id som skal slettes ligger i data_id
                $.ajax({
                    url: '@Url.Action("slettFlyrute", "Admin")',
                    data: { id: data_id },  // en parameter inn i slett(id)-metoden i kunde-kontrolleren (JSON-objekt)
                    success: function () {
                        // må kalle liste-metoden for å vise den nye listen av kunder
                        $.ajax({
                            url: '@Url.Action("FlyruterAdministrer", "Admin")',
                            success: function () {
                                // så må siden reloades!
                                window.location.reload();
                            }
                        });
                        }
                    });
                })
            })
        });
</script>

<h2>FlyruterAdministrer</h2>

<p>
    @Html.ActionLink("Legg til ny flyrute", "RegistrerFlyrute")
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.fraFlyplass)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.tilFlyplass)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.dato)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.tid)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.pris)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.flyTid)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.antallLedigeSeter)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.fraFlyplass)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.tilFlyplass)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.dato)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.tid)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.pris)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.flyTid)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.antallLedigeSeter)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.StrekningsID }) |
            @Html.ActionLink("Details", "Details", new { id=item.StrekningsID }) |
            <a href="#sletteFlyruterModal" class="btn btn-large btn-danger" id="sletteKnapp"
               data-navn="@item.tilFlyplass @item.fraFlyplass @item.dato @item.tid"
               data-id="@item.StrekningsID" data-toggle="modal" data-sletteFlyruterModal="true">Slett</a>
        </td>
    </tr>
}

</table>
@Html.Partial("SlettFlyruterModal")
